// ***************************************************************************
// Copyright (c) 2017, Industrial Logic, Inc., All Rights Reserved.
//
// This code is the exclusive property of Industrial Logic, Inc. It may ONLY be
// used by students during Industrial Logic's workshops or by individuals
// who are being coached by Industrial Logic on a project.
//
// This code may NOT be copied or used for any other purpose without the prior
// written consent of Industrial Logic, Inc.
// ****************************************************************************

"use strict";
var assert = require('assert')
, vows = require('vows')
, layouts = require('../lib/layouts')
, sandbox = require('sandboxed-module');

vows.describe('../lib/appenders/stderr').addBatch({
  'appender': {
    topic: function() {
      var messages = []
      , fakeProcess = {
          stderr: {
            write: function(msg) { messages.push(msg); }
          }
      }
      , appenderModule = sandbox.require(
        '../lib/appenders/stderr',
        {
          globals: {
            'process': fakeProcess
          }
        }
      )
      , appender = appenderModule.appender(layouts.messagePassThroughLayout);

      appender({ data: ["blah"] });
      return messages;
    },

    'should output to stderr': function(messages) {
      assert.equal(messages[0], 'blah\n');
    }
  }

}).exportTo(module);
