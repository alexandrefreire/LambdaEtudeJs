// ***************************************************************************
// Copyright (c) 2017, Industrial Logic, Inc., All Rights Reserved.
//
// This code is the exclusive property of Industrial Logic, Inc. It may ONLY be
// used by students during Industrial Logic's workshops or by individuals
// who are being coached by Industrial Logic on a project.
//
// This code may NOT be copied or used for any other purpose without the prior
// written consent of Industrial Logic, Inc.
// ****************************************************************************

var
  fs    = require('fs'),
  join  = require('path').join,
  spawn = require('./spawn');

spawn.tmpFunction({ unsafeCleanup: true }, function (err, name) {
  if (err) {
    spawn.err(err, spawn.exit);
    return;
  }

  try {
    // creates structure from issue 62
    // https://github.com/raszi/node-tmp/issues/62

    fs.mkdirSync(join(name, 'issue62'));

    ['foo', 'bar'].forEach(function(subdir) {
      fs.mkdirSync(join(name, 'issue62', subdir));
      fs.writeFileSync(join(name, 'issue62', subdir, 'baz.txt'), '');
    });

    spawn.out(name, spawn.exit);
  } catch (e) {
    spawn.err(e.toString(), spawn.exit);
  }
});
